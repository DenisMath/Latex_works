% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt



\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{tabularx}
\usepackage{array}
\usepackage{tikZ}
%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{margins=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES

\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}


%\usepackage{pst-plot,pstricks-add}

\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

%%% END Article customizations

%%% The "real" document content comes below...

\title{p-адические числа и p-адический анализ}
\author{Денис Морозов}
%\date{ } % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\newcommand{\tabcen}[2]{
\begin{tabular}{c}
#1\\
#2\\
\end{tabular}
}

\begin{document}
\maketitle
Будет рассмотрена арифметика кольца $\mathbb{Z}_p$ целых p-адических чисел.
\section{Преобразования Фурье над конечными полями.}



Рассмотрим мотивацию вычисления свертки над конечными полями вместо поля $\mathbb{C}$  комплексных чисел.

При применение свертки к фильтрации изображений входные данные являются целыми числами, и применение целочисленной арифметики для
работы с ними является естественным. При вычислении свертки над конечным полем, в отличии от поля $\mathbb{C}$ ,  отсутствует накопление погрешности вычислений. 

Результат свертки последовательности
 $$ 0\ 0\ 0\ 0\ 0\ 126\ 126\ 126\ 126\ 126\ 0\ 0\ 0\ 0\ 0\  126\ 126\ 126\ 126\ 126\ 0\ ...$$
 с ядром $-1\ 2\ 1$ с применением преобразования Фурье

 над полем $\mathbb{C}$  комплексных чисел:
$$ 0.00000\ 0.00000\ -0.00001\ -0.00002\ 0.00002\ 126.00000\ -125.99998\ 0.00001\ $$
$$ 0.00002\ -0.00000\ -125.99998\ 126.00002\ -0.00002\ -0.00000\ -0.00001\ 125.99999 ...$$

 над конечным полем $GF(p)$:
$$ 0\ 0\ 0\ 0\ 0\ 126\ -126\ 0\ 0\ 0\ 126\ -126\ 0\ 0\ 0\ 126\  ...$$

 Скорость же работы с целыми числами типа int для большинства процессоров значительно превышает скорость роботы
с данными типа float и double, с помощью которых реализуется арифметика поля $\mathbb{C}$ . Кроме того, как будет показано далее, при удачном выборе генератора преобразования 
Фурье над конечным полем умножение может быть заменено двоичными сдвигами, что тоже значительно уменьшает время выполнения преобразования. Так же вычисление обратного преобразования
Фурье содержит сложную операцию деления, которую в конечном поле можно заменить умножением на целый обратный элемент поля.

К сложности реализации преобразования Фурье над конечным полем следует отнести необходимость использования операции взятия по модулю размера поля. Скорость работы алгоритма непосредственно зависит от простоты реализации данной операции и от частоты ее использования.




\subsection{Преобразования Ферма над конечным полем.}

Рассмотрим преобразования Фурье над конечным полем Галуа $GF(2^{16}+1)$. Возьмем элемент $w$ порядка 1024, например $w=18729$. Найдем обратный к нему $w^{-1}=27119$. 
$w$ и  $w^{-1}$  являются генераторами соответственно для прямого и обратного преобразования Фурье длины 1024 над полем  $GF(2^{16}+1)$. Преобразование длины $2^n$ задается генератором
$w^{2^{10-n}}$ :

$$w^{1}=18729,\ w^{-1}=27119,\ length=1024 $$

$$w^{2}=21417,\  w^{-2}=-16053,\  length=512 $$

$$w^{4}=-5574,\ w^{-4}=7325,\   length=256 $$

$$w^{8}=4938,\ w^{-8}=-19178,\   length=128 $$

$$w^{16}=4080,\ w^{-16}=2040,\   length=64 $$

$$w^{32}=2,\ w^{-32}=-32768,\   length=32 $$

Генератор преобразования длины 32 равен 2, следовательно умножения в преобразовании Фурье можно заменить сдвигами.

Вычислим свертку длины 1024 методом Кули-Тьюки по схеме $32 \times 32$.

 По классической схеме преобразование  длины 32 можно также разбить на преобразования длины $k_1$ и $k_2$, где $k_1*k_2=32$.
Однако при таком подходе возрастает количество операций взятия по модулю поля  $GF(2^{16}+1)$,  кроме того добавляются операции, 
используемые для трансформации матрицы в алгоритме Кули-Тьюки, включающие операции измерения индексов подстановки и присваивания, что существенно увеличивает время выполнения алгоритма. 
 Дальнейшее снижение сложности может быть получено за счет использования для вычисления преобразований Фурье длины 32 вместо алгоритма Кули-Тьюки другого алгоритма.

Для использования нового алгоритма предварительно обработаем матрицу преобразования. Запись матрицы преобразования длины 32 в поле $GF(2^{16}+1)$ в виде неотрицательных остатков по модулю $2^{16}+1$ имеет 
несколько недостатков.

 Во первых неотрицательные остатки степеней двойки, больших   $2^{16}+1$ степенями двойки не являются, и мы лишаемся преимущества замены умножения сдвигами. Во вторых двоичное представление
 наибольшего положительного остатка $2^{16}$ занимает 17 битов, поэтому при умножении на матрицу преобразования возможно переполнение 32-битных регистров ( $2^{16}*2^{16}=2^{32}$ - результат занимает 33 бита) и приходится
 использовать длинную арифметику, что существенно увеличивает время выполнения алгоритма.

Для того, что бы избавиться от вышеперечисленных недостатков отнимем от всех элементов матрицы преобразования,
 больших $2^{15}$, $2^{16}+1$ столько раз, сколько необходимо, что бы данный элемент попал в диапазон  $[-2^{15}\dots 2^{15}]$ .


 Поскольку множество остатков по модулю  $2^{16}+1$  с операциями деления и умножения образует кольцо, то данная операция не повлияет на результат вычисления свертки, при условии,
 что входные и выходные данные также будут находиться в диапазоне $[-2^{15}\dots 2^{15}]$. 

После применения данной операции для вычисления свертки достаточно
 32~-~битной арифметики. Действительно, произведение двух чисел из диапазона
$[-2^{15}\dots 2^{15}]$ в двоичном представлении содержит 31 бит плюс один бит на знак($-2^{15}\cdot 2^{15}=-2^{30}$ - результат занимает 32 бита).


 Кроме того все элементы матрицы преобразования 
становятся степенями двойки, быть может умноженные на минус. Действительно, пусть элемент матрицы имеет вид $$ 2^{16+t} - k'*(2^{16}+1)\geqslant  0 $$  Преобразуем его к виду
 $$ 2^{15} \geqslant 2^{16+t} - k''*(2^{16}+1) \geqslant -2^{15}  $$ Положим $k'' = 2^t$. Дальше $$  2^{16+t} - k''*(2^{16}+1) = 2^{16+t} - 2^t*(2^{16}+1)= - 2^t   $$
Поскольку  $2^{32} \equiv 1\ mod (\ 2^{16} + 1)$, то можно считать, что  $ t \leqslant 15 $ , следовательно $ - 2^t  \geqslant -2^{15}  $
 ч.т.д.

Прямое вычисление преобразования Фурье при помощи матрицы, обработанной вышеприведенным методом содержит 992 сложения, 961 нетривиальный сдвиг вместо умножений, 64 операций быстрого взятия по модулю, реализованного, как
один сдвиг,
одно побитовое пересечение и одно вычитание, и 32 операций взятия по модулю, реализованного, как
три сдвига,
одно побитовое пересечение, три вычитания и одно сложение. То есть для вычисления прямого преобразования необходимо 1024 = 992 + 32 сложения, 160 вычитаний, 1121 = 961 + 160 сдвиг и 96 побитовых пересечений.

Заметим, что после обработки данным методом матрица приобретает определенную симметрию по строкам и столбцам, которую можно использовать для уменьшения количества
операций при вычислении преобразования длины 32.
 

Алгоритм, использующий симметрию для вычисления прямого преобразования длины 32 использует 190 = 158 + 32  сложений, 266 = 106 + 160 вычитаний, 315 = 155 + 160 сдвигов и 96 побитовых пересечений, что сравнимо
с количеством операций, используемых при итеративном использовании алгоритма Кули-Тьюки. ( По сравнению с алгоритмом Кули-Тьюки $2\times 16$ данный алгоритм на $30\%$ быстрее. Данные относительной
скорости алгоритмов для процессора Intel 2.9Ghz: Кули-Тьюки - 47, используемый алгоритм -  31).

\vspace{5pt}



\hspace*{-30pt}\begin{tabular}{|p{40pt}|p{40pt}|p{40pt}|p{40pt}|p{40pt}|p{40pt}|p{30pt}|p{40pt}|p{30pt}|}
\hline
 \multicolumn{2}{|p{80pt} }{Основной алгоритм комплексного БПФ по основанию два}& \multicolumn{2}{|p{80pt} }{Полностью оптимизированный алгоритм комплексного БПФ по основанию два}& \multicolumn{2}{|p{80pt} }{алгоритм Рейдера-Бреннера комплексного БПФ по основанию два}& \multicolumn{3}{|p{100pt} |}{Алгоритм БПФ, использующий симметрию матрицы преобразования}\\
\hline
Число вещественных умножений  &Число вещественных сложений &Число вещественных умножений &Число вещественных сложений &Число вещественных умножений &Число вещественных сложений& Число сдвигов & Число целых сложений & Число побитовых и ($\&$)\\
\hline
 320  & 480 & 88 & 408 & 68 & 512 & 315 & 456 & 96 \\

\hline
\end{tabular}


\vspace{10pt}

% \begin{tabularx}{\textwidth}{|X X|X X|X X | }
% \hline
% Основной алгоритм комплексного БПФ по основанию два & first line is short & secondline & \tabularnewline
% \hline
% bb & Second line is a whole paragraph. With several sentences...\tabularnewline
% \hline
% \end{tabularx}

 Однако при оценке количества операций, используемых при вычисления БПФ итеративным методом Кули-Тьюки необходимо учитывать так же операции, 
используемые для трансформации матрицы, включающие операции измерения индексов и присваивания, поскольку не известен общий алгоритм вычисления трансформации матрицы по месту в данном методе. Заметим, что в приведенной таблице данные операции не учитываются, а в алгоритме, использующем симметрию, эти операции отсутствуют.
\tikzstyle{format} = [regular polygon,regular polygon sides=9, draw, thin, fill=blue!20]
%\tikzstyle{format} = [diamond, draw, thin, fill=blue!20]
\tikzstyle{formatRed} = [ draw, thin, fill=red!40]
\tikzstyle{formatGreen} = [ draw, thin, fill=green!40]
\tikzstyle{mediumGreen} = [ellipse, draw, thin, fill=green!20, minimum height=2.5em]
\tikzstyle{mediumRed} = [ellipse, draw, thin, fill=red!20, minimum height=2.5em]
\tikzstyle{mediumOrange} = [ellipse, draw, thin, fill=orange!20, minimum height=2.5em]
 \tikzstyle{ann} = [draw=none,fill=none]
\begin{center}
\begin{tikzpicture}
\draw[very  thick,  <->]  (11,0)  node[above]  {$Size, 2^x$}
-|  (0,14)  node[left]  {$Time, ms$};
\draw[red,  thick] (0,0.0) node[formatRed]{} -- (1, 0.0) node[formatRed]{} -- (2, 0.0) node[formatRed]{} -- (3, 0.07) node[formatRed]{} -- (4, 0.15) node[formatRed]{} -- (5, 0.31) node[formatRed]{} -- (6, 0.62) node[formatRed]{} -- (7, 1.87) node[formatRed]{} -- (8, 2.81) node[formatRed]{} -- (9, 6.4) node[formatRed]{} -- (10, 13.28 )
node[formatRed]{};

\draw[dashed]    (0 , 13.28)  node[left]  {$13.28$}  --
 (10, 13.28 )  (10, 13.28 )  -- (10,0 )  node[below]  {$1024$};
\draw[dashed]    (0, 6.4)  node[left]  {$6.4$}  --
 (9, 6.4)  (9, 6.4)  -- (9,0)  node[below]  {$512$};
\draw[dashed]    (0, 2.81)  node[left]  {$2.81$}  --
 (8, 2.81)  (8, 2.81)  -- (8, 0)  node[below]  {$256$};
\draw[dashed]    (0, 1.87)  node[left]  {$1.87$}  --
 (7, 1.87)  (7, 1.87)  -- (7, 0)  node[below]  {$128$};
\draw[dashed]    (0, 0.62)  node[left]  {$0.62$}  --
 (6, 0.62)  (6, 0.62)  -- (6, 0)  node[below]  {$64$};
\draw[dashed]     (0, 0.31)  node[left]  {$0.31$}  --
  (5, 0.31)   (5, 0.31)  --  (5, 0)  node[below]  {$32$};


\end{tikzpicture}
\end{center}

\begin{center}
\begin{tikzpicture}
\draw[very  thick,  <->]  (11,0)  node[above]  {$ 2^x\times1024$}  node[below]  {$Size$}
-|  (0,16.5)  node[left]  {$Time$} node[right]  {$ ms$};
\draw[red,  thick] (0,0.0) node[formatRed]{} -- (1, 0.0) node[formatRed]{} -- (2, 0.0) node[formatRed]{} -- (3, 0.12) node[formatRed]{} -- (4, 0.25) node[formatRed]{} -- (5, 0.57) node[formatRed]{} -- (6, 1.06) node[formatRed]{} -- (7, 2.6) node[formatRed]{} -- (8, 4.6) node[formatRed]{} -- (9, 9.4) node[formatRed]{} -- (10, 15.7 )
node[formatRed]{};
\draw[green,  dashed]  (0, 3.2)  node[left]  {$3.2$}  -- (8, 3.2) node[formatGreen]{};
\draw[green,  dashed]  (0, 1.6)  node[left]  {$2.0$}  -- (7, 1.6) node[formatGreen]{};
\draw[green,  dashed]  (0, 6.2)  node[left]  {$6.2$}  -- (9, 6.2) node[formatGreen]{};

\draw[dashed]    (0 , 15.7)  node[left]  {$ 15.7$}  --
 (10,  15.7 )  (10,  15.7 )  -- (10,0 )  node[below]  {$1024$};
\draw[dashed]    (0, 9.4)  node[left]  {$9.4$}  --
 (9, 9.4)  (9, 9.4)  -- (9,0)  node[below]  {$512$};
\draw[dashed]    (0, 4.6)  node[left]  {$4.6$}  --
 (8, 4.6)  (8, 4.6)  -- (8, 0)  node[below]  {$256$};
\draw[dashed]    (0, 2.6)  node[left]  {$2.6$}  --
 (7, 2.6)  (7, 2.6)  -- (7, 0)  node[below]  {$128$};
\draw[dashed]    (0, 1.06)  node[left]  {$1.06$}  --
 (6, 1.06)  (6, 1.06)  -- (6, 0)  node[below]  {$64$};
\draw[dashed]     (0, 0.57)  node[left]  {$0.57$}  --
  (5, 0.57)   (5, 0.57)  --  (5, 0)  node[below]  {$32$};

% 6.41 2.51 128x128 
% 7.91 3.10 64x64
% 4.22 3.28 512x512
% 2.19      32x32
\end{tikzpicture}
\end{center}


\def\experiment{% Записываем данные в \experiment, дробная часть отделяется ТОЧКОЙ
% Version Time
0 0.0
1 0.0
2 0.0
3 0.07
4 0.15
5 0.31
6 0.62
7 1.87
8 2.81
9 6.4
10 13.28
%7 2.4
%8 1.2
}%

\def\experimentT{% Записываем данные в \experiment, дробная часть отделяется ТОЧКОЙ
% Version Time
%0 0.0
%1 0.0
%2 0.0
%3 0.07
%4 0.15
%5 0.31
6 0.63
%7 1.5
8 2.65
9 6.4
%10 14.53
}%

% \begin{pspicture}(0,0)(17,17)
% \psaxes[]{->}(0,0)(0,0)(11 ,16) % рисуем координатные оси
% \listplot[ plotstyle=line, linecolor=blue, linewidth=2pt, showpoints=true, dotstyle=Bo, dotsize=8pt]{\experiment} % точки на графике
% % \listplot[ plotstyle=line, linecolor=red , linewidth=2pt, showpoints=true, dotstyle=Bo, dotsize=8pt, linestyle=none ]{\experimentT} % точки на графике

% \end{pspicture}


\
\
\
\
\
\
\

На графике видно, что при увеличение размера входных данных в два раза время вычисления свертки возрастает приблизительно в два раза, что говорит о том, что сложность алгоритма близка к $N \log N$.
\subsection{Преобразования Мерсенна над конечным полем.}
Преобразования Фурье над следующими полями удобны простой арифметикой взятия по модулю поля:  

$GF(2^{13}-1), GF(2^{17}-1), GF(2^{19}-1), GF(2^{31}-1) $.

К сожалению малый порядок двойки в группе по умножению  в данных полях не позволяет заменить умножение сдвигами для больших длин преобразования Фурье, как в случае с полями Ферма.
\subsection{Преобразования Фурье над кольцом.}

Для корректного определения дискретного преобразования Фурье длины $n$ над кольцом необходимо существования элемента $w$ порядка $n$ ( $w^n = 1$ ),
при этом $n$ должен быть обратимым элементом мультипликативной подгруппы этого кольца. При данных условиях существует корректно определенное 
 прямое и обратное отображения Фурье  над данным кольцом, при помощи которых можно вычислить свертку. 

\subsection{Технические моменты.}




% % Japan
% \def\experimentT{% Записываем данные в \experiment, дробная часть отделяется ТОЧКОЙ
% % size speed
% 0 0.0
% 1 0.0
% 2 0.0
% 3 0.07
% 4 0.15
% 5 0.31
% 6 0.63
% 7 1.5
% 8 2.65
% 9 7.86432
% 10 6.31672
% }%

% % Kiss
% \def\experiment{% Записываем данные в \experiment, дробная часть отделяется ТОЧКОЙ
% % size speed
% 0 0.0
% 1 0.0
% 2 0.0
% 3 0.07
% 4 0.15
% 5 0.31
% 6 0.62
% 7 1.87
% 8 2.81
% 9 4.53711
% 10 4.36907

% }%


% % Andrew
% \def\experimentTh{% Записываем данные в \experiment, дробная часть отделяется ТОЧКОЙ
% % size speed
% 0 0.0
% 1 0.0
% 2 0.0
% 3 0.07
% 4 0.15
% 5 0.31
% 6 0.62
% 7 1.87
% 8 2.81
% 9 5.89824
% 10 4.80998

% }%

% \def\experimentF{% Записываем данные в \experiment, дробная часть отделяется ТОЧКОЙ
% % size speed
% 0 0.0
% 1 0.0
% 2 0.0
% 3 0.07
% 4 0.15
% 5 0.31
% 6 0.63
% 7 1.5
% 8 2.65
% 9 6.4
% 10 14.53
% }%



% \begin{pspicture}(0,0)(17,17)
% \psaxes[]{->}(0,0)(0,0)(13 ,16) % рисуем координатные оси
% \listplot[ plotstyle=line, linecolor=blue, linewidth=2pt, showpoints=true, dotstyle=Bo, dotsize=8pt]{\experiment} % точки на графике
% \listplot[ plotstyle=line, linecolor=red , linewidth=2pt, showpoints=true, dotstyle=Bo, dotsize=8pt ]{\experimentT} % точки на графике

% % \listplot[ plotstyle=line, linecolor=green, linewidth=2pt, showpoints=true, dotstyle=Bo, dotsize=8pt]{\experimentTh} % точки на графике
% % \listplot[ plotstyle=line, linecolor=orange , linewidth=2pt, showpoints=true, dotstyle=Bo, dotsize=8pt ]{\experimentF} % точки на графике

% \end{pspicture}

1. Уменьшение количества взятий по модулю.

2. Уменьшение количества операций преобразования Фурье длины 32, использующее  структуру матрицы преобразования. Увеличение скорости в 3 раза.

3. Переход от 64-битной арифметике к 32-битной. Увеличение скорости в 5 раз.

\

Пусть $A, B$ - матрицы размера $m \times n$, $R, R^{-1}$ - матрицы преобразования Фурье над строчками, $L, L^{-1}$ -  матрицы преобразования Фурье над столбиками.  

 Двумерная свертка матриц $A, B$  записывается формулой $$A \hat{\circ } B = L^{-1}((LAR)\circ (LBR))R^{-1}$$
Поскольку умножение матриц ассоциативно, то
$$A \hat{\circ } B = (L^{-1}((L(AR))\circ (L(BR)))R^{-1} = ((AR) \hat{\circ }_{c}(BR))R^{-1} = L^{-1}((LA) \hat{\circ }_{r}(LB)) $$

где $\hat{\circ }_{c}$ - свертка матриц по столбикам, а $\hat{\circ }_{r}$ - по строчкам. Следовательно результат двумерной свертки не зависит  от выбора генераторов
преобразований  $R, L$.

При вычислении преобразований Фурье над конечным полем алгоритмом Кули-Тьюки квадратная форма матрицы предпочтительнее,

 поскольку уменьшает количество взятий по модулю размера поля.
 Кроме того трансформация квадратной матрицы имеет простой алгоритм применения по месту.

Выбор схемы для  вычисления FFT длины 64: $8\times 8$ 

Свертку с большим ядром можно рассматривать, как последовательность сверток с маленьким ядром, предварительно разложив ядро на множители.


$$!1688\ \ \ \ \ 14407\ \ 14406\ =\ 2\ *\ 3\ *\ 7^4$$
$$!3138\ \ \ \ \ 28813\ \ 28812\ =\ 2^2\ *\ 3\ *\ 7^4$$
$$ 3512\ \ \ \ \ 32749\ \ 32748\ =\ 2^2\ *\ 3\ *\ 2729$$
$$\ \ \ \ \ \ \ \ \ \ 32771\ \ 32770\ =\ 2\ *\ 5\ *\ 29\ *\ 113$$
$$\ \ \ \ \ \ \ \ \ \ 32779\ \ 32778\ =\ 2\ *\ 3^3\ *\ 607$$
$$\ \ \ \ \ \ \ \ \ \ 32783\ \ 32782\ =\ 2\ *\ 37\ *\ 443$$
$$3516\ \ \ \ \ 32789\ \ 32788\ =\ 2^2\ *\ 7\ *\ 1171$$
$$3517\ \ \ \ \ 32797\ \ 32798\ =\ 2\ *\ 23^2\ *\ 31$$
$$!3518\ \ \ \ \ 32801\ \ 32800\ =\ 2^5\ *\ 5^2\ *\ 41$$
$$3519\ \ \ \ \ 32803\ \ 32802\ =\ 2\ *\ 3\ *\ 7\ *\ 11\ *\ 71$$
$$3520\ \ \ \ \ 32831\ \ 32830\ =\ 2\ *\ 5\ *\ 7^2\ *\ 67$$
$$\ \ \ \ \ \ \ \ \ \ 32833\ \ 32832\ =\ 2^6\ *\ 3^3\ *\ 19$$
$$\ \ \ \ \ \ \ \ \ \ 32839\ \ 32838\ =\ 2\ *\ 3\ *\ 13\ *\ 421$$
$$\ \ \ \ \ \ \ \ \ \ 32843\ \ 32842\ =\ 2\ *\ 16421$$
$$3524\ \ \ \ \ 32869\ \ 32868\ =\ 2^2\ *\ 3^2\ *\ 11\ *\ 83$$
$$3525\ \ \ \ \ 32887\ \ 32888\ =\ 2^3\ *\ 4111$$
$$3526\ \ \ \ \ 32909\ \ 32908\ =\ 2^2\ *\ 19\ *\ 433$$
$$3527\ \ \ \ \ 32911\ \ 32910\ =\ 2\ *\ 3\ *\ 5\ *\ 1097$$
$$3528\ \ \ \ \ 32917\ \ 32916\ =\ 2^2\ *\ 3\ *\ 13\ *\ 211$$
$$!3749\ \ \ \ \ 35153\ \ 35152\ =\ 2^4\ *\ 13^3$$
$$!!4144\ \ \ \ \ 39367\ \ 39366\ =\ 2\ *\ 3^9 \ \ \ (-2)^{2*3^7}=1$$
$$!5675\ \ \ \ \ 55903\ \ 55902\ =\ 2\ *\ 3\ *\ 7\ *\ 11^3\ \ \ \ (-2)^{2*3*7*11^3}=1$$
$$!!5905\ \ \ \ \ 58321\ \ 58320\ =\ 2^4\ *\ 3^6\ *\ 5\ \ \ \ \ 2^{2^3 3^5 5}=1$$
$$6000\ \ \ \ \ 59359\ \ 59358\ =\ 2\ *\ 3\ *\ 13\ *\ 761$$
$$6100\ \ \ \ \ 60497\ \ 60498\ =\ 2\ *\ 3^2\ *\ 3361\ \ \ $$
$$6200\ \ \ \ \ 61631\ \ 61630\ =\ 2\ *\ 5\ *\ 6163$$
$$!!6276\ \ \ \ \ 62501\ \ 62500\ =\ 2^2\ *\ 5^6\ \ \ \ (-2)^{2^2*5^6}=$$
$$6300\ \ \ \ \ 62773\ \ 62772\ =\ 2^2\ *\ 3\ *\ 5231$$
$$6400\ \ \ \ \ 63809\ \ 63808\ =\ 2^6\ *\ 997$$
$$!!6426\ \ \ \ \ 64153\ \ 64152\ =\ 2^3\ *\ 3^6 * 11 \ \ \ 2^{2^2* 3^5 *11}=1 $$

$$6500\ \ \ \ \ 65063\ \ 65062\ =\ 2\ *\ 32531$$
$$6501\ \ \ \ \ 65071\ \ 65070\ =\ 2\ *\ 3^3\ *\ 5\ *\ 241$$
$$6510\ \ \ \ \ 65147$$
$$6520\ \ \ \ \ 65267$$
$$6530\ \ \ \ \ 65381$$
$$6531\ \ \ \ \ 65393\ \ 65392\ =\ 2^4\ *\ 61\ *\ 67$$
$$6532\ \ \ \ \ 65407\ \ 65406\ =\ 2\ *\ 3\ *\ 11\ *\ 991$$
$$6533\ \ \ \ \ 65413\ \ 65412\ =\ 2^2\ *\ 3^2\ *\ 23\ *\ 79\ \ 65413\ divides\ 34^{23}-1$$
$$6534\ \ \ \ \ 65419\ \ 65418\ =\ 2\ *\ 3\ *\ 10903$$
$$6535\ \ \ \ \ 65423\ \ 65422\ =\ 2\ *\ 7\ *\ 4673$$
$$6536\ \ \ \ \ 65437\ \ 65436\ =\ 2^2\ *\ 3\ *\ 7\ *\ 19\ *\ 41$$
$$6537\ \ \ \ \ 65447\ \ 65446\ =\ 2\ *\ 43\ *\ 761$$
$$6538\ \ \ \ \ 65449\ \ 65448\ =\ 2^3\ *\ 3^4\ *\ 101\ 65449\ =\ 80^2+243^2\ 65449^2\ =\ 38880^2+52649^2\ 65449\ =\ 2^{16}-87$$
$$6539\ \ \ \ \ 65479\ \ 65478\ =\ 2\ *\ 3\ *\ 7\ *\ 1559$$
$$6540\ \ \ \ \ 65497\ \ 65498\ =\ 2\ *\ 32749$$
$$6541\ \ \ \ \ 65519\ \ 2\ *\ 17\ *\ 41\ *\ 47$$
$$!6542\ \ \ \ \ 65521\ \ 65520\ =\ 2^4\ *\ 3^2\ *\ 5\ *\ 7\ *\ 13 \ \ \ 65521 = 2^{16}-15 \ \ 2^{2*3^2*5*13} = 1$$
$$6543\ \ \ \ \ 65537\ \ 65536\ =\ 2^{16}$$
$$6545\ \ \ \ \ 65543$$
$$6549\ \ \ \ \ 65579$$
$$!8008\ \ \ \ \  81901\ \  81900 = 2^2 * 3^2 * 5^2 * 7 * 13\ \ 2^{81900} = 1\ \  81901 = 5*2^{14} - 19 $$ 
 
\vspace{1cm}

% Time is measured for one layer convolution with specified image and kernel sizes. 
% Resulted time is mean for several test executions. 
% Test program was launched on Wave I target with enabled LIB_NEON compilation directive.

$$Fourier [800\times 600] = 901 ms$$
$$Fourier [640\times 480] = 520 ms$$
$$Fourier [480\times 320] = 290.75 ms$$
$$Fourier [320\times 240] = 122.56 ms$$
$$Fourier [160\times 120] = 27 ms$$
$$Fourier [80\times 40]   = 4.15 ms$$

\vspace{2cm}

$$!!Fourier [1024\times 1024] = 2092 ms$$
$$!Fourier [512\times 512]   = 467 ms$$
$$Fourier [256\times 256]   = 91.27 ms$$
$$!!Fourier [128\times 128]   = 21.17 ms$$
$$Fourier [64\times 64]     = 5.13 ms$$
$$Fourier [32\times 32]     = 1.42 ms$$
$$Fourier [16\times 16]     = 0.5 ms$$
 
\vspace{1cm}
$$!!Ferma [1024\times 1024]   = 1402 ms$$
$$!Ferma [512\times 512]     = 506 ms$$
$$!!Ferma [256\times 256]     = 61.12 ms$$
$$Ferma [128\times 128]     = 51.05 ms$$
$$Ferma [64\times 64]       = 11.41 ms$$
$$Ferma [32\times 32]       = 2.61 ms$$
$$Ferma [16\times 16]       = 1.19 ms$$
\hspace*{-20pt}\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
 Two Dim & 1024 & 512 & 256 & 128 & 64 & 32 & 16 \\
\hline
\hline
 Furie  & 2092 & 467 & 91.27 & 21.17 & 5.13 & 1.42 & 0.5 \\
\hline
 Ferma  & 1402 & 506 & 61.12 & 51.05 & 11.41 & 2.61 & 1.19 \\

\hline
\end{tabular}
\vspace{.5cm}

\hspace*{-20pt}\begin{tabular}{|c|c|c|c|}
\hline
 hSize & vSize & T (repeat) & Time  \\
\hline
\hline
 $256=16\times16$  & $256=16\times16$ & 100 & 691 \\
\hline
 $256=16t\times16t$  & $256=16t\times16t$ & 100 & 984 \\
\hline
 $64tt = 8\times8$  & $64tt = 8\times8$ & 1000 & 500 \\
\hline
 $64t = 2\times32$  & $64t = 2\times32$ & 1000 & 734 \\
\hline
\end{tabular}
\vspace{.5cm}

Продолжение...
\begin{center}
\begin{tikzpicture}
\draw[very  thick,  <->]  (5,0)  node[below]  {$Q$}
-|  (0,5)  node[left]  {$P$};
\draw[red,  thick]  (0.5,0.5) --  (4.5,4.5)
node[above]  {$S$};
\draw[blue,  thick]  (0.5,4.5)  parabola[bend  at  end]
(4.5,0.5)  node[right]  {$D$};
\draw[blue,  thick]  (1.5,4.5)  parabola[bend  at  end]
(4.5,1.5)  node[right]  {$D’$};
\draw[dashed]    (0,1.5)  node[left]  {$P_1$}  --
(2.5,1.5)  (2.5,1.5)  --  (2.5,0)  node[below]  {$Q_1$};
\draw[dashed]    (0,2.2)  node[left]  {$P_2$}  --
(3.1,2.2)  (3.1,2.2)  --  (3.1,0)  node[below]  {$Q_2$};
\end{tikzpicture}
\end{center}
% ./configure	--prefix='c:/Program Files/Emacs/emacs/' 
% 		--with-texmf-dir='c:/Program Files/MiKTeX 2.8' 
% 		--with-lispdir='c:/Program Files/Emacs/site-lisp'

\end{document}
%GS="c:/Program Files/gs/gs9.02/bin/gswin32c.exe" ./configure --prefix='c:/Program Files/Emacs/emacs' --with-texmf-dir='c:/Program Files/MiKTeX 2.8'  --with-lispdir='c:/Program Files/Emacs/site-lisp' c:\Program Files\Emacs\

% \begin{tabular}{|c|c|c|}
% \hline
%    & \tabcen{Player 2}{chooses left}   
%    & \tabcen{Player 2}{chooses right}  \\
% \hline
%      \tabcen{Player 1}{chooses top}   
%    & 4, 3
%    & --1, --1                        \\
% \hline   
%      \tabcen{Player 1}{chooses bottom}
%      & 0, 0
%        & 3, 4                     \\
% \hline   
% \end{tabular}


% \begin{tabularx}{\textwidth}{lX}
% aa & first line is short\tabularnewline
% bb & Second line is a whole paragraph. With several sentences...\tabularnewline
% \end{tabularx}